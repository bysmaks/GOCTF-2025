# MATEEEEEO | REVERSE

## Информация

> Поговори с ботом.
>
> b3BlbnNzbCBlbmMgLWFlcy0yNTYtY2JjIC1zYWx0IC1pbiBvYmZ1c2NhdGVkX2ZsYWcuc2ggLW91dCBvYmZ1c2NhdGVkX2ZsYWcuc2guZW5jIC1wYmtkZjIgLXBhc3MgcGFzczo8eW91cl9wYXNzd29yZD4i
>
> Бот - @goctf2025_bot

## Деплой

```sh
cd deploy
docker-compose up --build -d
```

## Выдать участинкам

[public/](public/) и ссылку на тг-бота

## Описание

ТГ-бот спрашивает имя, проверяет гошным бинарём, выводит первую часть ключа. Затем спрашивает пароль, проверяет запакованным с++-бинарём, выводит вторую часть ключа. С помощью ключа расшифровывается bash-скрипт, который позволяет получить ключ для бота, чтобы тот вывел флаг.

## Решение

0. **Декомпилим bot.pyc с помощью pycdc/pylingual.com**
1. **Получение имени**
Бинарь на Go просто считает sha1 от введённого имени. С помощью [сайта](https://crackstation.net/) получает имя "balerina".
2. **Получение пароля**
С помощью Detect it easy понимаем, что на С++ бинарь запакован с помощью upx. Делаем 'upx -d checker_cpp_upx', получаем бинарь. В бинаре сначала расшифровывается эталонная строка, затем создаёт вектор на 8 символов. В векторе должна лежать строка, равная эталонной "hJXzbLNp". Видим, что поддерживается 3 типа команд: 1_n - поставить 'a' в n-ый регистр, 2_n - поставить 'A' в n-ый регистр, 3_3_n - увеличивает n-ыф символ на 2. Путём несложных математических преобразований получаем [пароль](src/pass.txt).
3. **Расшифровка Bash-скрипта**
Получив обе половины ключа и декодировав base64-строку из задания, расшифровываем bash-скрипт с помощью команды 'openssl enc -d -aes-256-cbc -salt -in obfuscated_flag.sh.enc -out flag.sh -pbkdf2 -pass pass:"l>no]:>L^*<u@8x,;moJ>N#TddSW0xU1G
C0=,cDetoQ0;Tncvt9,"
'.
4. **Bash-скрипт**
Видим, что скрипт - обычный crackme. Он запрашивает ключ и сдвиг. Далее он шифрует цезарем с переданным сдвигом и кодирует в base64. Затем сравнивает с эталонной. Мы делаем: декодируем (например, с помощью [cyberchef](https://gchq.github.io/CyberChef/)) и перебираем все сдвиги (их всего-то 26). Отправляем боту полученный ключ и получаем флаг.

## Флаг

`goctf{Ital1An_bRa1nr0T_1S_1nteREsT1nG}`

